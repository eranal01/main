<!DOCTYPE html>
<html>
<head>
<title>Ranalli Assignment 4</title>
</head>
<body>
<h1>Introduction</h1>
<p>I have been tasked with finding as many security and privacy vulnerabilities in Ming Chow’s implementation of the 2048 game server (Comp 20’s Assignment 3). This document will describe the vulnerabilities that were found and offer potential resolutions to the vulnerabilities.</p>
<h1>Methodology</h1>
<p>To find the vulnerabilities in Ming’s implementation of the server, I used multiple techniques. To begin, I used curl to send data to the server through the  “https://gameserver2048.herokuapp.com/submit”  url. This allowed me to insert potentially malicious user input into the system and to attempt to overload the system with excess data. I also manipulated the query strings in the address bar with the url “https://gameserver2048.herokuapp.com/scores.json”. </p>
<p>I inspected the source code Ming provided on Piazza. This allowed me to investigate potential vulnerabilities in the system and understand if there were any protections already in place to prevent some of those vulnerabilities.
</p>
<h1>Abstract of Findings</h1>
<p>I found three major security and privacy issues in Ming Chow’s implementation of the 2048 game server. First, user input is trusted. There are no limits to what the user can input when asked for their username after a game ends. Because of this, users can enter malicious javascript using “script” tags. The javascript can be used to change the page in any way a hacker desires, including adding dangerous content to a page or redirecting the page to any url.</p>
<p>The second major issue I identified was in the protection of data. As a feature of the program, users are able to search for scores by username. Dangerously, user input is trusted. Because of this, malicious users can trick the search functionality to reveal data for all users instead of one specific user. Malicious users are able to change the search from “find all usernames matching name X” to “find all usernames NOT matching X” with a simple addition of database search logic. This could reveal the data of all users which is a major privacy breach. </p>
<p>The third security issue I determined is in how much data the server can hold. All user input data is stored in a database. Databases have a finite amount of data that can be held. This is something that hackers can prey on. Malicious users can write a script to continuously send data to the server to fill up the database. Eventually, the database will fill up and not be able to take any more input. When this happens, the application will break. Even before the application breaks, performance will be slowed immensely by the large amount of data that must be loaded. This is a security issue that can be exploited. </p>

<h1>Issues Found</h1>

<h2>Issue 1: Cross Site Scripting (XSS)</h2><h3>Location:</h3><p>Entering username on frontend</p><h3>Severity:</h3><p>High severity. Hacker has complete control over action of the page. Can prevent anyone from using page by redirecting all users to another page. </p><h3>Description of issue:</h3><p>The code takes input provided by the user in the username field and displays it with the user’s score. No parsing or limitation of characters protects the program. Because of this, if a user were to write javascript within '<'script'>' and '<'/script'>', the code reads through it and runs the javascript as it attempts to write the username and score to the screen. This gives a hacker complete control over the behavior of the page</p><h3>Proof of Vulnerability:</h3><p>An alert was scripted to appear when a user landed on the game server homepage. <img src = "Proof_of_issue1" alt="Home page with alert, Why??"></p><h3>Resolution:</h3><p>This issue can be resolved with two simple fixes. The first is to limit the character entry of the username field to 15 characters (or any number that doesn’t allow for two complete script tags). The other is to strip the username of all special symbols (anything that isn’t a letter). This way “<” and “>” symbols could not longer be used to denote a script tag. The combination of both resolutions would prevent cross site scripting in the username entry.</p>

<h2>Issue 2: Injection</h2><h3>Location:</h3><p>Injection into mongodb database (https://gameserver2048.herokuapp.com/scores.json)</p><h3>Severity:</h3><p>Low. Although all data can be viewed by the hacker, there is not incredibly sensitive data. This would be a bigger breach if usernames and passwords or other identifying information was stored in the database.
</p><h3>Description of issue:</h3><p>A feature of the program is that a user can search for the scores of a specific username. If the username doesn’t exist, no scores appear. The username is stored in a query string like this: https://gameserver2048.herokuapp.com/scores.json?username=batman. The string is then used to query the database. In this example, the database is queried for a username that matches “batman”. The application uses a NoSQL database, Mongodb. Mongodb has certain input logic that a hacker can manipulate. Instead of searching for a username that equals batman, a hacker can insert dangerous query logic into the query string to look for all usernames that are not equal to batman. The new query looks like this: https://gameserver2048.herokuapp.com/scores.json?username[$ne]=batman. In this case, all data that isn’t batman will appear, revealing potentially sensitive information on all users (not named batman) using the system.</p><h3>Proof of Vulnerability:</h3><p>PIC</p><h3>Resolution:</h3><p>To resolve this problem, the query string must be checked. The system could check the query string for any operator, like $. If an operator is contained in the string, the query can be stopped and the system can throw an error.</p>

<h2>Issue 3: Exhausting the database</h2><h3>Location:</h3><p>Mongodb database (https://gameserver2048.herokuapp.com/submit)</p><h3>Severity:</h3><p>Medium. Although the vulnerability can cause issues with load time and crashes, there is no data leaked through this vulnerability or major behavior changes that could harm a typical user.
</p><h3>Description of issue:</h3><p>Databases can hold a large, but finite, amount of data. As this application holds more data in its database and loads all of that data onto its home page, the load time of the application increases. As the database reaches its limit of data it can hold, it will not be able to accept more user input and may crash. In this case, a hacker can write a script continuously that posts usernames, scores, and grids (using curl) to the server. I (with help of a partner) hit the game server with over 200,000 documents to hold. Although the program did not crash, the performance was significantly slowed. 
</p><h3>Proof of Vulnerability:</h3><p>PIC</p><h3>Resolution:</h3><p>To resolve this issue, a limit could be set on the number of submissions by a particular IP address. </p>

<h1>Conclusion</h1> <p>The most important lesson learned through this exercise is to never trust user input. Although these were three different vulnerabilities that I identified, they all stemmed from the system accepting user input at face value. Instead, the system must put limits on the what the user can input check what the user has inputted in order to prevent dangerous vulnerabilities. As I take this learning with me in other applications as a human factors engineer, it is important to understand not just what mistakes users might make but also what malicious actions users might take when designing a product or service. Ideally, design should nudge a user toward good behavior, whether that is nudging users away from mistakes or even malicious behavior. Although it may require more time and additional costs, it is always important to analyze and check user input in any system to prevent even more costly attacks from malicious users.</p>
<h1>References</h1> <p>The following references were used: <ul> 
<li>https://en.wikipedia.org/wiki/Cross-site_scripting </li> 
<li>https://www.computerhope.com/unix/uecho.htm</li>
<li>https://tuftsdev.github.io/WebProgramming/notes/web_security.html</li>
<li>https://www.youtube.com/watch?v=lcO1BTNh8r8</li></ul>

I worked with Lena Chang on this assignment (particularly to exhaust the database) and talked to Linda Cameron (a former Comp20 student) for help.	
</p>


</body>
</html>